package cc.slack.features.modules.impl.exploit.disablers.vulcan;

import cc.slack.events.impl.network.PacketEvent;
import cc.slack.events.impl.player.WorldEvent;
import cc.slack.features.modules.impl.exploit.disablers.IDisabler;
import cc.slack.utils.network.PacketUtil;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C07PacketPlayerDigging;
import net.minecraft.util.BlockPos;
import net.minecraft.util.EnumFacing;

public class OldVulcanStrafeDisabler implements IDisabler {

    int c03Counter = 0;

    @Override
    public void onEnable() {
        c03Counter = -15;
    }

    @Override
    public void onWorld(WorldEvent event) {
        c03Counter = -15;
    }

    @Override
    public void onPacket(PacketEvent event) {
        if (event.getPacket() instanceof C03PacketPlayer) {
            c03Counter++;
            if (((C03PacketPlayer) event.getPacket()).isMoving()) {
                if (c03Counter >= 6) {
                    PacketUtil.sendNoEvent(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.STOP_DESTROY_BLOCK, BlockPos.ORIGIN, EnumFacing.DOWN));
                    c03Counter = 0;
                } else if (c03Counter == 6 - 2) {
                    PacketUtil.sendNoEvent(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.START_DESTROY_BLOCK, BlockPos.ORIGIN, EnumFacing.DOWN));
                }
            }
        }
    }
    @Override
    public String toString() {
        return "Old Vulcan Strafe";
    }
}
